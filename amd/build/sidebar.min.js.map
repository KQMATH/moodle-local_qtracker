{"version":3,"sources":["../src/sidebar.js"],"names":["Sidebar","container","show","side","loading","width","margin","closable","options","hidden","visible","mql","window","matchMedia","addEventListener","screenTest","bind","render","e","matches","css","getSide","self","context","close","length","Templates","then","html","js","replaceNodeContents","setVisibility","setLoading","setSide","width2","addClass","removeClass","empty","appendNodeContents","children","toggleClass","doc","DOMParser","parseFromString","documentElement","textContent"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Manager for managing a sidebar.\n *\n * @module     local_qtracker/Sidebar\n * @class      Sidebar\n * @package    local_qtracker\n * @author     Andr√© Storhaug <andr3.storhaug@gmail.com>\n * @copyright  2021 NTNU\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport $ from 'jquery';\nimport Templates from 'core/templates';\n\n/**\n * Constructor\n * @constructor\n * @param {String} selector used to find triggers for the new group modal.\n * @param {int} contextid\n *\n * Each call to init gets it's own instance of this class.\n */\nclass Sidebar {\n    hidden = null;\n    loading = null;\n    width = null;\n    margin = null;\n    container = null;\n    closable = null;\n    options = null;\n\n    constructor(container, show = false, side = 'right', loading = false, width = '40%', margin = '0px', closable = true, options = []) {\n        this.container = $(container); // Container element\n        this.hidden = !show;\n        this.visible = show;\n        this.side = side;\n        this.loading = loading;\n        this.width = width;\n        this.margin = margin;\n\n        this.closable = closable;\n        this.options = options;\n\n        this.mql = window.matchMedia('(min-width: 768px)');\n        this.mql.addEventListener('change', this.screenTest.bind(this));\n\n        this.render = this.render.bind(this);\n    }\n\n    screenTest(e) {\n        if (!this.visible) {\n            return;\n        }\n        if (e.matches) {\n            /* the viewport is 768px pixels wide or more */\n            $('#qtracker-sidebar').css('width', 'calc(' + this.width + ' - -1.25rem)');\n            $('.qtracker-push-pane-over').css('padding-' + this.getSide(), 'calc(' + this.width + ' - -' + this.margin + ')');\n        } else {\n            /* the viewport is more than 768px pixels wide or less */\n            $('#qtracker-sidebar').css('width', '100%');\n            $('.qtracker-push-pane-over').css('padding-' + this.getSide(), '0');\n        }\n    }\n\n    async render() {\n        let self = this;\n\n        let context = {};\n        if (this.closable) {\n            context.close = {\n                \"key\": \"fa-times\",\n                \"title\": \"Close\",\n                \"alt\": \"Close pane\",\n                \"extraclasses\": \"\",\n                \"unmappedIcon\": false\n            };\n        }\n        if (this.options.length > 0) {\n            context.options = {\n                \"trigger\": {\n                    \"key\": \"fa-filter\",\n                    \"title\": \"Options\",\n                    \"alt\": \"Show options\",\n                    \"extraclasses\": \"\",\n                    \"unmappedIcon\": false\n                },\n                \"header\": false,\n                \"items\": self.options,\n            };\n        }\n\n        //let self = this;\n        await Templates.render('local_qtracker/sidebar', context).then((html, js) => {\n            Templates.replaceNodeContents(this.container, html, js);\n            this.setVisibility(!this.hidden);\n            this.setLoading(this.loading);\n            this.setSide(this.side);\n            this.screenTest(this.mql)\n        });\n    }\n\n    getSide() {\n        return this.side;\n    }\n\n    getOppositeSide() {\n        return this.side == 'left' ? 'right' : 'left';\n    }\n\n    /**\n     *\n     * @param {*} width The sidebar width\n     * @param {*} width2 The existing content width\n     */\n    setWidth(width, width2) {\n        this.width = width;\n        this.width2 = width2;\n\n        this.screenTest(this.mql);\n    }\n\n    isMobileWidth() {\n        return !this.mql.matches;\n    }\n    setSide(side) {\n        if (side == 'right') {\n            $('#qtracker-sidebar').addClass('qtracker-sidebar-right');\n            $('#qtracker-sidebar').removeClass('qtracker-sidebar-left');\n        } else if (side == 'left') {\n            $('#qtracker-sidebar').addClass('qtracker-sidebar-left');\n            $('#qtracker-sidebar').removeClass('qtracker-sidebar-right');\n        }\n    }\n\n    setTitle(html) {\n        $('.qtracker-sidebar-title').html(html);\n    }\n\n    setLoading(show = true) {\n        if (show) {\n            $('.qtracker-sidebar-content .loading').addClass(\"show\");\n            this.loading = true;\n        } else {\n            $('.qtracker-sidebar-content .loading').removeClass(\"show\");\n            this.loading = false;\n        }\n    }\n\n    empty() {\n        $('.qtracker-sidebar-content .qtracker-items').empty();\n    }\n\n    addTemplateItem(html, js) {\n        Templates.appendNodeContents('.qtracker-sidebar-content .qtracker-items', html, js);\n    }\n\n    getItems() {\n        return $('.qtracker-sidebar-content .qtracker-items').children();\n    }\n\n    getContainer() {\n        return this.container;\n    }\n\n    hide() {\n        if (!this.hidden) {\n            this.setVisibility(false);\n        }\n    }\n\n    show() {\n        if (this.hidden) {\n            this.setVisibility(true);\n        }\n    }\n\n    setVisibility(show = true) {\n        if (show) {\n            $('.qtracker-push-pane-over').css('padding-' + this.getSide(), 'calc(' + this.width + ' - -' + this.margin + ')');\n            $('#qtracker-sidebar').addClass('show');\n            this.screenTest(this.mql);\n        } else {\n            $('.qtracker-push-pane-over').css('padding-' + this.getSide(), '0');\n            $('#qtracker-sidebar').removeClass('show');\n        }\n        this.hidden = !show;\n        this.visible = show;\n    }\n\n    togglePane() {\n        $('.qtracker-container').toggleClass('qtracker-push-pane-over');\n        $('#qtracker-sidebar').toggleClass(\"show\");\n        this.hidden = !this.hidden;\n    }\n\n    decodeHTML(html) {\n        var doc = new DOMParser().parseFromString(html, \"text/html\");\n        return doc.documentElement.textContent;\n    }\n}\n\nexport default Sidebar;\n"],"file":"sidebar.min.js"}