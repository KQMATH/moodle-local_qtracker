{"version":3,"file":"issue_manager.min.js","sources":["../src/issue_manager.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Manager for managing question issues.\n *\n * @module     local_qtracker/IssueManager\n * @class      IssueManager\n * @package    local_qtracker\n * @author     Andr√© Storhaug <andr3.storhaug@gmail.com>\n * @copyright  2020 NTNU\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'local_qtracker/issue'], function ($, Issue) {\n\n    /**\n     * Constructor\n     * @constructor\n     * @param {String} selector used to find triggers for the new group modal.\n     * @param {int} contextid\n     *\n     * Each call to init gets it's own instance of this class.\n     */\n    var IssueManager = function () { };\n\n    /**\n     * @var {Form} form\n     * @private\n     */\n    IssueManager.prototype.issues = new Map();\n\n    IssueManager.prototype.activeIssue = null;\n\n    IssueManager.prototype.getActiveIssue = function () {\n        return this.activeIssue;\n    };\n\n    IssueManager.prototype.setActiveIssue = function (slot) {\n        let newIssue = this.getIssueBySlot(slot);\n        this.activeIssue = newIssue;\n        return newIssue;\n    };\n\n    /**\n     * This triggers a form submission, so that any mform elements can do final tricks before the form submission is processed.\n     *\n     * @method submitForm\n     * @param slot\n     * @private\n     * @return\n     */\n    IssueManager.prototype.getIssueBySlot = function (slot) {\n        return this.issues.get(slot);\n    };\n\n    IssueManager.prototype.getIssueById = function (id) {\n        for (const [slot, issue] of this.issues) {\n            if (issue.getId() !== null && issue.getId() === id) {\n                return issue;\n            }\n        }\n        return false;\n    };\n\n    IssueManager.prototype.addIssue = function (issue) {\n        this.issues.set(issue.getSlot(), issue);\n    };\n\n    IssueManager.prototype.loadIssues = function (issueids = []) {\n        let promises = [];\n        for (let i = 0; i < issueids.length; i++) {\n            const id = issueids[i];\n            let promise = Issue.loadData(id).then((response) => {\n                let issue = this.getIssueBySlot(response.issue.slot);\n                if (!issue) {\n                    issue = new Issue(response.issue.id, response.issue.slot);\n                }\n                issue.setId(response.issue.id);\n                issue.setTitle(response.issue.title);\n                issue.setDescription(response.issue.description);\n                issue.isSaved = true;// ChangeState(Issue.STATES.EXISTING);\n                this.addIssue(issue);\n            });\n            promises.push(promise);\n        }\n        return Promise.all(promises);\n    };\n\n    return IssueManager;\n});\n"],"names":["define","$","Issue","IssueManager","prototype","issues","Map","activeIssue","getActiveIssue","this","setActiveIssue","slot","newIssue","getIssueBySlot","get","getIssueById","id","issue","getId","addIssue","set","getSlot","loadIssues","issueids","promises","i","length","promise","loadData","then","response","setId","setTitle","title","setDescription","description","isSaved","push","Promise","all"],"mappings":";;;;;;;;;;AAyBAA,sCAAO,CAAC,SAAU,yBAAyB,SAAUC,EAAGC,WAUhDC,aAAe,oBAMnBA,aAAaC,UAAUC,OAAS,IAAIC,IAEpCH,aAAaC,UAAUG,YAAc,KAErCJ,aAAaC,UAAUI,eAAiB,kBAC7BC,KAAKF,aAGhBJ,aAAaC,UAAUM,eAAiB,SAAUC,UAC1CC,SAAWH,KAAKI,eAAeF,kBAC9BJ,YAAcK,SACZA,UAWXT,aAAaC,UAAUS,eAAiB,SAAUF,aACvCF,KAAKJ,OAAOS,IAAIH,OAG3BR,aAAaC,UAAUW,aAAe,SAAUC,QACvC,MAAOL,KAAMM,SAAUR,KAAKJ,UACP,OAAlBY,MAAMC,SAAoBD,MAAMC,UAAYF,UACrCC,aAGR,GAGXd,aAAaC,UAAUe,SAAW,SAAUF,YACnCZ,OAAOe,IAAIH,MAAMI,UAAWJ,QAGrCd,aAAaC,UAAUkB,WAAa,eAAUC,gEAAW,GACjDC,SAAW,OACV,IAAIC,EAAI,EAAGA,EAAIF,SAASG,OAAQD,IAAK,OAChCT,GAAKO,SAASE,OAChBE,QAAUzB,MAAM0B,SAASZ,IAAIa,MAAMC,eAC/Bb,MAAQR,KAAKI,eAAeiB,SAASb,MAAMN,MAC1CM,QACDA,MAAQ,IAAIf,MAAM4B,SAASb,MAAMD,GAAIc,SAASb,MAAMN,OAExDM,MAAMc,MAAMD,SAASb,MAAMD,IAC3BC,MAAMe,SAASF,SAASb,MAAMgB,OAC9BhB,MAAMiB,eAAeJ,SAASb,MAAMkB,aACpClB,MAAMmB,SAAU,OACXjB,SAASF,UAElBO,SAASa,KAAKV,gBAEXW,QAAQC,IAAIf,WAGhBrB"}